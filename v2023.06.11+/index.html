<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <script src="lib/convexhull.js"></script>
  <script src="lib/geometry.js"></script>
  <script src="lib/mincut.js"></script>
  <script src="lib.js"></script>
  <script src="scene.js"></script>
  <script src="editingPointsCloudMode.js"></script>
  <script src="https://unpkg.com/konva@9/konva.min.js"></script>
  <link href="style.css" rel="stylesheet">
</head>

<body>
  <div id="viewport-aligner">
    <div id="viewport-wrapper">
      <div id="viewport" class="crosshair-cursor"></div>
      <img id="settings-icon" src="settings-icon.svg">
      <div id="settings">
        <div class="setting">
          <svg width="25" height="25">
            <g stroke="black">
              <line x1="8" y1="0" x2="8" y2="25" stroke-width="3" />
              <line x1="17" y1="0" x2="17" y2="25" stroke-width="3" />

              <line x1="0" y1="8" x2="25" y2="8" stroke-width="3" />
              <line x1="0" y1="17" x2="25" y2="17" stroke-width="3" />
            </g>
          </svg>
          <label>Масштаб сітки:</label>
          <input id="grid-step">
        </div>
        <div class="setting">
          <div id="line-type" class="dropdown-icon">
            <div class="current-icon" value="solid">
              <svg width="20" height="25">
                <g stroke="black">
                  <line x1="8" y1="0" x2="8" y2="25" stroke-width="5" />
                </g>
              </svg>
            </div>
            <div class="list-of-icons">
              <div class="list-item" value="dashed">
                <svg width="20" height="25">
                  <g stroke="black">
                    <line x1="8" y1="0" x2="8" y2="5" stroke-width="5" />
                    <line x1="8" y1="10" x2="8" y2="15" stroke-width="5" />
                    <line x1="8" y1="20" x2="8" y2="25" stroke-width="5" />
                  </g>
                </svg>
              </div>
            </div>
            <div class="dropdown-btn">▼</div>
          </div>
          <label>Ширина лінії чотирикутника:</label>
          <input id="quadrangle-side-width">
        </div>
        <div class="setting">
          <svg width="25" height="25">
            <circle cx="12.5" cy="12.5" r="10" stroke="black" fill="#0e2e13" />
          </svg>
          <label>Радіус вершин чотирикутника:</label>
          <input id="quadrangle-vertices-radius">
        </div>
        <div class="setting">
          <svg width="25" height="25">
            <g stroke="black">
              <line x1="12.5" y1="0" x2="12.5" y2="25" stroke-width="5" />
              <line x1="7" y1="2" x2="18" y2="2" stroke-width="3" />
              <line x1="8" y1="12.5" x2="17" y2="12.5" stroke-width="2" />
              <line x1="7" y1="24" x2="18" y2="24" stroke-width="3" />
            </g>
          </svg>
          <label>Довжина осей:</label>
          <input id="axis-length">
        </div>
        <div class="setting">
          <img src="protractor-icon.svg" width="25">
          <label>
            Відображення довжин та<br>
            градусних мір кутів
          </label>
          <input id="show-metrics" type="checkbox" checked>
        </div>
        <button id="update-btn" class="settings-btn">Застосувати налаштування</button>
        <button id="toggle-editing-points-mode-btn" class="settings-btn">Вимкнути режим редагування точок</button>
        <button id="build-min-quadrangle" class="settings-btn">Побудувати мін. чотирикутник</button>
      </div>
      <img id="trash-can-icon" src="trash-can.svg">
      <script src="controls.js"></script>
    </div>
  </div>
  <script>
    const initialSettings = {
      "gridStep": 4.6,
      "quadrangleSideWidth": 5,
      "quadrangleVerticesRadius": 9,
      "lineType": "solid",
      "axisLength": 20,
      "areMetricsShown": true
    }
    initializeSettings(initialSettings);
    let scene = new Scene(initialSettings);
    let editor = new Editor(scene);
    document.getElementById("update-btn").addEventListener("click", () => updateSettings(scene));
    document.getElementById("toggle-editing-points-mode-btn")
      .addEventListener("click", (e) => {
        const currentMode = editor.toggle(e, e.currentTarget.value);
        e.currentTarget.value = !currentMode;
        e.currentTarget.innerText = currentMode == Editor.Modes.Enabled ?
          "Вимкнути режим редагування точок" : "Ввімкнути режим редагування точок";
      });
    document.getElementById("build-min-quadrangle")
      .addEventListener("click", (e) => {
        const quadrangleCutType = document.getElementById("build-min-quadrangle").value;
        editor.toggle(e, Editor.Modes.Disabled, quadrangleCutType);
        document.getElementById("toggle-editing-points-mode-btn").value = Editor.Modes.Enabled;
        document.getElementById("toggle-editing-points-mode-btn").innerText = "Ввімкнути режим редагування точок";
        e.currentTarget.value = quadrangleCutType == QuadrangleCut.Type.Optimal ?
          QuadrangleCut.Type.Standart : QuadrangleCut.Type.Optimal;
        e.currentTarget.innerText = quadrangleCutType != QuadrangleCut.Type.Optimal ?
          "Побудувати мін. чотирикутник" : "Побудувати мін. ромб";
      });
  </script>
</body>

</html>